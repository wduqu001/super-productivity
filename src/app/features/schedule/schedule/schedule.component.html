<!--  <div class="title">February 2019 Week 6</div>-->

<header stuck>
  <!-- TODO extract to component of its own? -->
  <div class="main-controls">
    <button
      mat-icon-button
      [disabled]="true"
    >
      <mat-icon>chevron_left</mat-icon>
    </button>
    <div>Current Week</div>
    <button mat-icon-button>
      <mat-icon>chevron_right</mat-icon>
    </button>

    <div><strong>~</strong>Flow source:</div>
    <!--    <div><mat-icon>airwave</mat-icon> Flow from:</div>-->

    <button
      mat-button
      [matMenuTriggerFor]="menu"
    >
      <mat-icon>wb_sunny</mat-icon>
      Today
    </button>
    <mat-menu #menu="matMenu">
      <button mat-menu-item>Only show appointments</button>
      <button mat-menu-item>Show tasks from X</button>
    </mat-menu>
  </div>

  <div class="days">
    <div class="filler"></div>
    <div class="filler"></div>

    @for (day of daysToShow$|async; track $index) {
    <div class="day">
      <div class="day-num">{{ day|date:'d' }}</div>
      <div class="day-day">{{ day|date:'EEE' }}</div>
    </div>
    }
  </div>
</header>

<div class="container">
  <!-- https://codepen.io/kjellmf/pen/qgxyVJ -->
  <!-- https://codepen.io/una/pen/YzpgYRR -->
  <div class="content {{containerExtraClass}}">
    <!-- Time -->
    @for (time of times; track $index) {
    <div
      class="time"
      style="grid-row: {{ $index *FH + 1 }}"
    >
      {{ time }}
    </div>
    }
    <!-- Grid Cols -->
    @for (col of colByNr; track $index) {
    <div
      class="col"
      style="grid-column: {{ $index + 3 }}"
    >
      <div class="drop-on-col-info">
        <mat-icon>add</mat-icon>
        <div>Drop here to plan for day</div>
      </div>
    </div>
    }

    <!-- Grid Rows -->
    @for (row of rowsByNr; track $index) {
    <div
      class="row"
      style="grid-row: {{ row + 1 }}"
    ></div>
    }

    <!--    &lt;!&ndash; Events &ndash;&gt;-->
    <!--    @for (event of events; track $index) {-->
    <!--    <div-->
    <!--      class="event calendar1"-->
    <!--      [style]="event.style"-->
    <!--    >-->
    <!--      {{ event.title }}-->
    <!--    </div>-->
    <!--    }-->

    <!-- Events -->
    @for (ev of (events$|async); track $index) {
    <!-- -->
    @if (ev.type === 'Task' || ev.type === 'SplitTask' || ev.type === 'TaskPlannedForDay'
    || ev.type === 'SplitTaskPlannedForDay' || ev.type === 'TaskScheduled') {
    <schedule-event
      class="draggable"
      cdkDrag
      [cdkDragData]="ev"
      (cdkDragMoved)="dragMoved($event)"
      (cdkDragStarted)="dragStarted($event)"
      (cdkDragReleased)="dragReleased($event)"
      [event]="ev"
    ></schedule-event>
    } @else {
    <schedule-event [event]="ev"></schedule-event>
    } }

    <div
      class="current-time"
      [style]="currentTimeStyle$|async"
    >
      <div class="circle"></div>
    </div>
  </div>
</div>
